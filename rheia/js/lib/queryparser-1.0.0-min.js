/*
 * http://pegjs.majda.cz/
 *
 * Generated by PEG.js 0.7.0.
 * from followin grammar:
 * Query =
 *   Expression / ''
 *
 * Expression =
 *   left:AndExpr right:(' '+ 'or' ' '+ AndExpr )*
 *   {
 *     if(right.length) {
 *       var result = {or: [left]}
 *       for( var i=0; i < right.length; i++) {
 *         result.or.push(right[i][3]);
 *       }
 *       return result;
 *     } else {
 *       return left;
 *     }
 *   }
 *
 * AndExpr =
 *   left:Term right:(' '+ 'and' ' '+ Term )*
 *   {
 *     if(right.length) {
 *       var result = {and: [left]}
 *       for( var i=0; i < right.length; i++) {
 *         result.and.push(right[i][3]);
 *       }
 *       return result;
 *     } else {
 *       return left;
 *     }
 *   }
 *
 * Term =
 *   Token
 * /
 *   '(' ' '* expr:Expression ' '* ')' 
 *   {return expr;}
 *
 * Token =
 *   id:Identifier ' '* ':' ' '* val:Value 
 *   {
 *     var obj = {};
 *     obj[id] = val;
 *     return obj;
 *   }
 *
 * Identifier = 
 *   first:[a-zA-Z_] next:[a-zA-Z0-9_]* 
 *   {return first+next.join('');}
 *
 * Value =
 *   Boolean / String / Float / Integer / Regex / '!'
 *
 * Regex = 
 *   '/' content:('\\/' / [^/])+ '/' flag:('i'/'m')? 
 *   {return new RegExp(content.join(''), flag);}
 *
 * Boolean =
 *   'true' / 'false'
 *
 * Integer =
 *   sign:'-'? digit:[0-9]+ 
 *   {return parseInt(sign+digit.join(''));}
 *
 * Float =
 *   digit:Integer '.' decimal:[0-9]+ 
 *   {return parseFloat(digit+'.'+decimal.join(''));}
 *
 * String = 
 *   '"' content:('\\"' / [^"])* '"' 
 *   {return content.join('');} 
 * /
 *   "'" content:("\\'" / [^'])* "'" 
 *   {return content.join('');}
 */
QueryParser=(function(){function b(c){return'"'+c.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var a={parse:function(o,u){var c={Query:q,Expression:B,AndExpr:h,Term:g,Token:v,Identifier:k,Value:E,Regex:l,Boolean:n,Integer:C,Float:d,String:w};if(u!==undefined){if(c[u]===undefined){throw new Error("Invalid rule name: "+b(u)+".")}}else{u="Query"}var f=0;var y=0;var i=0;var z=[];var s={};function A(G,K,I){var F=G;var J=I-G.length;for(var H=0;H<J;H++){F=K+F}return F}function x(H){var G=H.charCodeAt(0);var F;var I;if(G<=255){F="x";I=2}else{F="u";I=4}return"\\"+F+A(G.toString(16).toUpperCase(),"0",I)}function r(F){if(f<i){return}if(f>i){i=f;z=[]}z.push(F)}function q(){var H="Query@"+f;var F=s[H];if(F){f=F.nextPos;return F.result}var G;G=B();if(G===null){G=""}s[H]={nextPos:f,result:G};return G}function B(){var M="Expression@"+f;var G=s[M];if(G){f=G.nextPos;return G.result}var L,K,J,I,H,F;var P,O,N;P=f;O=f;L=h();if(L!==null){K=[];N=f;if(o.charCodeAt(f)===32){I=" ";f++}else{I=null;if(y===0){r('" "')}}if(I!==null){J=[];while(I!==null){J.push(I);if(o.charCodeAt(f)===32){I=" ";f++}else{I=null;if(y===0){r('" "')}}}}else{J=null}if(J!==null){if(o.substr(f,2)==="or"){I="or";f+=2}else{I=null;if(y===0){r('"or"')}}if(I!==null){if(o.charCodeAt(f)===32){F=" ";f++}else{F=null;if(y===0){r('" "')}}if(F!==null){H=[];while(F!==null){H.push(F);if(o.charCodeAt(f)===32){F=" ";f++}else{F=null;if(y===0){r('" "')}}}}else{H=null}if(H!==null){F=h();if(F!==null){J=[J,I,H,F]}else{J=null;f=N}}else{J=null;f=N}}else{J=null;f=N}}else{J=null;f=N}while(J!==null){K.push(J);N=f;if(o.charCodeAt(f)===32){I=" ";f++}else{I=null;if(y===0){r('" "')}}if(I!==null){J=[];while(I!==null){J.push(I);if(o.charCodeAt(f)===32){I=" ";f++}else{I=null;if(y===0){r('" "')}}}}else{J=null}if(J!==null){if(o.substr(f,2)==="or"){I="or";f+=2}else{I=null;if(y===0){r('"or"')}}if(I!==null){if(o.charCodeAt(f)===32){F=" ";f++}else{F=null;if(y===0){r('" "')}}if(F!==null){H=[];while(F!==null){H.push(F);if(o.charCodeAt(f)===32){F=" ";f++}else{F=null;if(y===0){r('" "')}}}}else{H=null}if(H!==null){F=h();if(F!==null){J=[J,I,H,F]}else{J=null;f=N}}else{J=null;f=N}}else{J=null;f=N}}else{J=null;f=N}}if(K!==null){L=[L,K]}else{L=null;f=O}}else{L=null;f=O}if(L!==null){L=(function(U,T,S){if(S.length){var Q={or:[T]};for(var R=0;R<S.length;R++){Q.or.push(S[R][3])}return Q}else{return T}})(P,L[0],L[1])}if(L===null){f=P}s[M]={nextPos:f,result:L};return L}function h(){var M="AndExpr@"+f;var G=s[M];if(G){f=G.nextPos;return G.result}var L,K,J,I,H,F;var P,O,N;P=f;O=f;L=g();if(L!==null){K=[];N=f;if(o.charCodeAt(f)===32){I=" ";f++}else{I=null;if(y===0){r('" "')}}if(I!==null){J=[];while(I!==null){J.push(I);if(o.charCodeAt(f)===32){I=" ";f++}else{I=null;if(y===0){r('" "')}}}}else{J=null}if(J!==null){if(o.substr(f,3)==="and"){I="and";f+=3}else{I=null;if(y===0){r('"and"')}}if(I!==null){if(o.charCodeAt(f)===32){F=" ";f++}else{F=null;if(y===0){r('" "')}}if(F!==null){H=[];while(F!==null){H.push(F);if(o.charCodeAt(f)===32){F=" ";f++}else{F=null;if(y===0){r('" "')}}}}else{H=null}if(H!==null){F=g();if(F!==null){J=[J,I,H,F]}else{J=null;f=N}}else{J=null;f=N}}else{J=null;f=N}}else{J=null;f=N}while(J!==null){K.push(J);N=f;if(o.charCodeAt(f)===32){I=" ";f++}else{I=null;if(y===0){r('" "')}}if(I!==null){J=[];while(I!==null){J.push(I);if(o.charCodeAt(f)===32){I=" ";f++}else{I=null;if(y===0){r('" "')}}}}else{J=null}if(J!==null){if(o.substr(f,3)==="and"){I="and";f+=3}else{I=null;if(y===0){r('"and"')}}if(I!==null){if(o.charCodeAt(f)===32){F=" ";f++}else{F=null;if(y===0){r('" "')}}if(F!==null){H=[];while(F!==null){H.push(F);if(o.charCodeAt(f)===32){F=" ";f++}else{F=null;if(y===0){r('" "')}}}}else{H=null}if(H!==null){F=g();if(F!==null){J=[J,I,H,F]}else{J=null;f=N}}else{J=null;f=N}}else{J=null;f=N}}else{J=null;f=N}}if(K!==null){L=[L,K]}else{L=null;f=O}}else{L=null;f=O}if(L!==null){L=(function(U,T,S){if(S.length){var Q={and:[T]};for(var R=0;R<S.length;R++){Q.and.push(S[R][3])}return Q}else{return T}})(P,L[0],L[1])}if(L===null){f=P}s[M]={nextPos:f,result:L};return L}function g(){var L="Term@"+f;var F=s[L];if(F){f=F.nextPos;return F.result}var K,J,I,H,G;var N,M;K=v();if(K===null){N=f;M=f;if(o.charCodeAt(f)===40){K="(";f++}else{K=null;if(y===0){r('"("')}}if(K!==null){J=[];if(o.charCodeAt(f)===32){I=" ";f++}else{I=null;if(y===0){r('" "')}}while(I!==null){J.push(I);if(o.charCodeAt(f)===32){I=" ";f++}else{I=null;if(y===0){r('" "')}}}if(J!==null){I=B();if(I!==null){H=[];if(o.charCodeAt(f)===32){G=" ";f++}else{G=null;if(y===0){r('" "')}}while(G!==null){H.push(G);if(o.charCodeAt(f)===32){G=" ";f++}else{G=null;if(y===0){r('" "')}}}if(H!==null){if(o.charCodeAt(f)===41){G=")";f++}else{G=null;if(y===0){r('")"')}}if(G!==null){K=[K,J,I,H,G]}else{K=null;f=M}}else{K=null;f=M}}else{K=null;f=M}}else{K=null;f=M}}else{K=null;f=M}if(K!==null){K=(function(P,O){return O})(N,K[2])}if(K===null){f=N}}s[L]={nextPos:f,result:K};return K}function v(){var L="Token@"+f;var F=s[L];if(F){f=F.nextPos;return F.result}var K,J,I,H,G;var N,M;N=f;M=f;K=k();if(K!==null){J=[];if(o.charCodeAt(f)===32){I=" ";f++}else{I=null;if(y===0){r('" "')}}while(I!==null){J.push(I);if(o.charCodeAt(f)===32){I=" ";f++}else{I=null;if(y===0){r('" "')}}}if(J!==null){if(o.charCodeAt(f)===58){I=":";f++}else{I=null;if(y===0){r('":"')}}if(I!==null){H=[];if(o.charCodeAt(f)===32){G=" ";f++}else{G=null;if(y===0){r('" "')}}while(G!==null){H.push(G);if(o.charCodeAt(f)===32){G=" ";f++}else{G=null;if(y===0){r('" "')}}}if(H!==null){G=E();if(G!==null){K=[K,J,I,H,G]}else{K=null;f=M}}else{K=null;f=M}}else{K=null;f=M}}else{K=null;f=M}}else{K=null;f=M}if(K!==null){K=(function(Q,R,P){var O={};O[R]=P;return O})(N,K[0],K[4])}if(K===null){f=N}s[L]={nextPos:f,result:K};return K}function k(){var L="Identifier@"+f;var H=s[L];if(H){f=H.nextPos;return H.result}var J,G,F;var K,I;K=f;I=f;if(/^[a-zA-Z_]/.test(o.charAt(f))){J=o.charAt(f);f++}else{J=null;if(y===0){r("[a-zA-Z_]")}}if(J!==null){G=[];if(/^[a-zA-Z0-9_]/.test(o.charAt(f))){F=o.charAt(f);f++}else{F=null;if(y===0){r("[a-zA-Z0-9_]")}}while(F!==null){G.push(F);if(/^[a-zA-Z0-9_]/.test(o.charAt(f))){F=o.charAt(f);f++}else{F=null;if(y===0){r("[a-zA-Z0-9_]")}}}if(G!==null){J=[J,G]}else{J=null;f=I}}else{J=null;f=I}if(J!==null){J=(function(O,N,M){return N+M.join("")})(K,J[0],J[1])}if(J===null){f=K}s[L]={nextPos:f,result:J};return J}function E(){var H="Value@"+f;var F=s[H];if(F){f=F.nextPos;return F.result}var G;G=n();if(G===null){G=w();if(G===null){G=d();if(G===null){G=C();if(G===null){G=l();if(G===null){if(o.charCodeAt(f)===33){G="!";f++}else{G=null;if(y===0){r('"!"')}}}}}}}s[H]={nextPos:f,result:G};return G}function l(){var M="Regex@"+f;var I=s[M];if(I){f=I.nextPos;return I.result}var K,H,G,F;var L,J;L=f;J=f;if(o.charCodeAt(f)===47){K="/";f++}else{K=null;if(y===0){r('"/"')}}if(K!==null){if(o.substr(f,2)==="\\/"){G="\\/";f+=2}else{G=null;if(y===0){r('"\\\\/"')}}if(G===null){if(/^[^\/]/.test(o.charAt(f))){G=o.charAt(f);f++}else{G=null;if(y===0){r("[^\\/]")}}}if(G!==null){H=[];while(G!==null){H.push(G);if(o.substr(f,2)==="\\/"){G="\\/";f+=2}else{G=null;if(y===0){r('"\\\\/"')}}if(G===null){if(/^[^\/]/.test(o.charAt(f))){G=o.charAt(f);f++}else{G=null;if(y===0){r("[^\\/]")}}}}}else{H=null}if(H!==null){if(o.charCodeAt(f)===47){G="/";f++}else{G=null;if(y===0){r('"/"')}}if(G!==null){if(o.charCodeAt(f)===105){F="i";f++}else{F=null;if(y===0){r('"i"')}}if(F===null){if(o.charCodeAt(f)===109){F="m";f++}else{F=null;if(y===0){r('"m"')}}}F=F!==null?F:"";if(F!==null){K=[K,H,G,F]}else{K=null;f=J}}else{K=null;f=J}}else{K=null;f=J}}else{K=null;f=J}if(K!==null){K=(function(P,O,N){return new RegExp(O.join(""),N)})(L,K[1],K[3])}if(K===null){f=L}s[M]={nextPos:f,result:K};return K}function n(){var H="Boolean@"+f;var F=s[H];if(F){f=F.nextPos;return F.result}var G;if(o.substr(f,4)==="true"){G="true";f+=4}else{G=null;if(y===0){r('"true"')}}if(G===null){if(o.substr(f,5)==="false"){G="false";f+=5}else{G=null;if(y===0){r('"false"')}}}s[H]={nextPos:f,result:G};return G}function C(){var L="Integer@"+f;var H=s[L];if(H){f=H.nextPos;return H.result}var J,G,F;var K,I;K=f;I=f;if(o.charCodeAt(f)===45){J="-";f++}else{J=null;if(y===0){r('"-"')}}J=J!==null?J:"";if(J!==null){if(/^[0-9]/.test(o.charAt(f))){F=o.charAt(f);f++}else{F=null;if(y===0){r("[0-9]")}}if(F!==null){G=[];while(F!==null){G.push(F);if(/^[0-9]/.test(o.charAt(f))){F=o.charAt(f);f++}else{F=null;if(y===0){r("[0-9]")}}}}else{G=null}if(G!==null){J=[J,G]}else{J=null;f=I}}else{J=null;f=I}if(J!==null){J=(function(N,M,O){return parseInt(M+O.join(""))})(K,J[0],J[1])}if(J===null){f=K}s[L]={nextPos:f,result:J};return J}function d(){var M="Float@"+f;var I=s[M];if(I){f=I.nextPos;return I.result}var K,H,G,F;var L,J;L=f;J=f;K=C();if(K!==null){if(o.charCodeAt(f)===46){H=".";f++}else{H=null;if(y===0){r('"."')}}if(H!==null){if(/^[0-9]/.test(o.charAt(f))){F=o.charAt(f);f++}else{F=null;if(y===0){r("[0-9]")}}if(F!==null){G=[];while(F!==null){G.push(F);if(/^[0-9]/.test(o.charAt(f))){F=o.charAt(f);f++}else{F=null;if(y===0){r("[0-9]")}}}}else{G=null}if(G!==null){K=[K,H,G]}else{K=null;f=J}}else{K=null;f=J}}else{K=null;f=J}if(K!==null){K=(function(O,P,N){return parseFloat(P+"."+N.join(""))})(L,K[0],K[2])}if(K===null){f=L}s[M]={nextPos:f,result:K};return K}function w(){var L="String@"+f;var H=s[L];if(H){f=H.nextPos;return H.result}var J,G,F;var K,I;K=f;I=f;if(o.charCodeAt(f)===34){J='"';f++}else{J=null;if(y===0){r('"\\""')}}if(J!==null){G=[];if(o.substr(f,2)==='\\"'){F='\\"';f+=2}else{F=null;if(y===0){r('"\\\\\\""')}}if(F===null){if(/^[^"]/.test(o.charAt(f))){F=o.charAt(f);f++}else{F=null;if(y===0){r('[^"]')}}}while(F!==null){G.push(F);if(o.substr(f,2)==='\\"'){F='\\"';f+=2}else{F=null;if(y===0){r('"\\\\\\""')}}if(F===null){if(/^[^"]/.test(o.charAt(f))){F=o.charAt(f);f++}else{F=null;if(y===0){r('[^"]')}}}}if(G!==null){if(o.charCodeAt(f)===34){F='"';f++}else{F=null;if(y===0){r('"\\""')}}if(F!==null){J=[J,G,F]}else{J=null;f=I}}else{J=null;f=I}}else{J=null;f=I}if(J!==null){J=(function(N,M){return M.join("")})(K,J[1])}if(J===null){f=K}if(J===null){K=f;I=f;if(o.charCodeAt(f)===39){J="'";f++}else{J=null;if(y===0){r('"\'"')}}if(J!==null){G=[];if(o.substr(f,2)==="\\'"){F="\\'";f+=2}else{F=null;if(y===0){r('"\\\\\'"')}}if(F===null){if(/^[^']/.test(o.charAt(f))){F=o.charAt(f);f++}else{F=null;if(y===0){r("[^']")}}}while(F!==null){G.push(F);if(o.substr(f,2)==="\\'"){F="\\'";f+=2}else{F=null;if(y===0){r('"\\\\\'"')}}if(F===null){if(/^[^']/.test(o.charAt(f))){F=o.charAt(f);f++}else{F=null;if(y===0){r("[^']")}}}}if(G!==null){if(o.charCodeAt(f)===39){F="'";f++}else{F=null;if(y===0){r('"\'"')}}if(F!==null){J=[J,G,F]}else{J=null;f=I}}else{J=null;f=I}}else{J=null;f=I}if(J!==null){J=(function(N,M){return M.join("")})(K,J[1])}if(J===null){f=K}}s[L]={nextPos:f,result:J};return J}function j(H){H.sort();var I=null;var G=[];for(var F=0;F<H.length;F++){if(H[F]!==I){G.push(H[F]);I=H[F]}}return G}function D(){var F=1;var I=1;var J=false;for(var G=0;G<Math.max(f,i);G++){var H=o.charAt(G);if(H==="\n"){if(!J){F++}I=1;J=false}else{if(H==="\r"||H==="\u2028"||H==="\u2029"){F++;I=1;J=true}else{I++;J=false}}}return{line:F,column:I}}var m=c[u]();if(m===null||f!==o.length){var e=Math.max(f,i);var p=e<o.length?o.charAt(e):null;var t=D();throw new this.SyntaxError(j(z),p,e,t.line,t.column)}return m},toSource:function(){return this._source}};a.SyntaxError=function(f,g,h,d,e){function c(k,l){var i,j;switch(k.length){case 0:i="end of input";break;case 1:i=k[0];break;default:i=k.slice(0,k.length-1).join(", ")+" or "+k[k.length-1]}j=l?b(l):"end of input";return"Expected "+i+" but "+j+" found."}this.name="SyntaxError";this.expected=f;this.found=g;this.message=c(f,g);this.offset=h;this.line=d;this.column=e};a.SyntaxError.prototype=Error.prototype;return a})();