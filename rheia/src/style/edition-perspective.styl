/*
  Copyright 2010,2011,2012 Damien Feugas
  
    This file is part of Mythic-Forge.

    Myth is free software: you can redistribute it and/or modify
    it under the terms of the GNU Lesser Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Myth is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Lesser Public License for more details.

    You should have received a copy of the GNU Lesser Public License
    along with Mythic-Forge.  If not, see <http://www.gnu.org/licenses/>.
*/

// TODO: remove later
html
body 
  height 100%

img.dragged
  width 40px

.affect-field 
  size = 50px

  .images-container
    margin 1em 0

  .loadable:focus
    border-color grey

  .loadable
    border 1px dotted transparent
    display inline-block
    width size
    margin 0 0.5em
    cursor pointer

    *
      cursor pointer

    p 
      width size
      height size - 13
      font-size 10px
      margin 0
      padding-top 13px
      vertical-align bottom

    img
      width size
      height size

    .ui-icon
      display none

  .loadable.selected
    box-shadow: 0 0 10px 5px #AAA

.affect-field.ui-dialog-content
    text-align center

.edition.perspective
  position relative
  width 100%
  height 100%

  .row 
    // Grid system freely inspired by http://semantic.gs/examples/fluid/fluid.html 
    padding = 15px
    columnWidth = 60px
    columns = 12
    leftSpan = 2
    gridWidth = (columnWidth+padding)*columns - padding
    totalWidth = 100%
    hMargin = totalWidth*((padding*0.5)/gridWidth)/2

    // Compute the cell width
    // @param num [Number] number of column spaned.
    getWidth(num)
      totalWidth * ((((padding+columnWidth)*num) - padding)/gridWidth)

    position absolute
    top padding
    left padding*0.5
    right padding*0.5
    bottom padding

    .cell
      float left
      height 100%
      position relative

    .left.cell
      width getWidth(leftSpan)
      margin 0 hMargin

    .right.cell
      width getWidth(columns - leftSpan)
      margin 0 hMargin
      padding 0
      typeIcons '.new', 25 

      .new-button 
        vertical-align middle

      .ui-tabs-nav .content.modified:before
        content '*'

      .ui-tabs.action-bars
        display inline-block
        padding 0
        border none
        margin-left 20px
        vertical-align middle

        .ui-tabs-nav
          display none

        .ui-tabs-panel
          padding 0

  // explorer behaviour
  .explorer 
    overflow auto
    height 100%
    width 100%

    dt 
      hoverable()
      typeIcons '> i',  25, 0 5px 0 0
      font-size 1.1em
      padding 5px 2px

    // open/close icons
    dt::before
      content ''
      display: inline-block
      background-image url(images/tree.png)
      background-repeat no-repeat
      height 18px 
      width 18px
      vertical-align middle
      margin-right -5px

    dt.open::before
      background-position -18px 0px

    dd > *:not(dd)
      hoverable()
      padding 0.5em 0 0.5em 1em
      imageDim = 40px

      img
        width imageDim
        height imageDim

      .carousel
      img
        vertical-align -1.2em
        margin-right 5px
        display inline-block

      .carousel
        .mask
        .thumbnail
          height imageDim
          width imageDim

        .previous
        .next 
          vertical-align (imageDim/3)px

    dd > dd
      margin-left 1em

    dd > dt::before
      margin-right 0px

    dd.rules img 
    dd.turn-rules img
      height 0
      width 0.3em
      vertical-align top

    dd.rules .inactive
    dd.turn-rules .inactive
      inactive()

  .ui-tabs.views
    takeSpace 40px, 0, 0

    .ui-tabs-nav
      width 100%
      padding-top 2px
      box-sizing border-box

    .ui-tabs-panel
      takeSpace 50px, 0, 0
      overflow auto

    .ui-icon-close
      display inline-block
      cursor: pointer

    li a
      padding: 0.2em 0.5em
      typeIcons '.icon', 25, 0

  // views
  .view

    > h1
      font-weight 700
      border-bottom 1px solid borderColor
      margin-bottom 10px
      padding-bottom 10px
      width 100%

    > .errors
      border-radius radius
      background-color errorColor

      > *
        padding 0.5em 1em
      * 
        color white

    > table
    > div
      margin-top 10px
      width 100%

      td 
        vertical-align top

      .left
        width 120px

        label
          width 100%
          margin-bottom 0.5em
          text-align center

        > .loadable
          margin 0 auto

        .images-container

          .loadable
            margin 0 auto 1em auto

      .right
        padding-left 2em
        
        > *
          margin-bottom 1em

        label
          width 90px

        .properties
          border 1px solid borderColor
          border-collapse collapse
          width 100%

          th 
            table-header()
            padding 0.5em 1em

          th:nth-child(1)
          th:nth-child(2)
            width 25%
            border-bottom 1px solid borderColor
            border-right 1px solid borderColor

          td
            vertical-align top
            padding 0.2em

          td > a
            height 18px
            width 18px

            .ui-icon
              top 1px
              left 1px

      label 
        display inline-block
        width 130px
        margin-right 1em
        padding-top 0.4em
        text-align right
        vertical-align top

      :not(.adv-editor) textarea
        width 75%
        resize vertical

      input[type=text]
        min-width 50%

  // rule views

  .view.rule.inactive
  .view.turn-rule.inactive
    > h1
      inactive()

  .view.rule:not(.icon)
  .view.turn-rule:not(.icon)
    takeSpace(1em, 1.4em, 1em, 1.4em)

    > div input[type="text"]
      min-width 25%
      
    > .content.ace_editor
      takeSpace(65px)
      margin 0
      border 1px solid borderColor

      *
        font-family 'Monaco','Menlo','Ubuntu Mono','Droid Sans Mono','Consolas',monospace
        font-size 12px
        line-height 16px
      
  .view.rule.error > .content.ace_editor
  .view.turn-rule.error > .content.ace_editor
    top 100px

  // map view
  .view.map

    .map-widget 
      margin 20px auto 10px
